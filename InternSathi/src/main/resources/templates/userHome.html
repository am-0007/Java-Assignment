<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InternSathi - Home</title>
    <link rel="stylesheet" th:href="@{/css/style2.css}">
</head>
<body>
<header>
    <div class="header-content">
        <div class="logo">InternSathi</div>
        <nav class="navbar">
            <ul class="navbar-nav">
                <li class="nav-item"><a href="#">Home</a></li>
                <li class="nav-item"><a href="#">About</a></li>
                <li class="nav-item"><a href="#">Contact Us</a></li>
            </ul>
        </nav>
        <div class="logout-button">
            <ul class="navbar-nav">
                <li class="nav-item"><a th:href="@{/logout}">Logout</a></li>
            </ul>
        </div>
    </div>
</header>

<main>
    <p>Welcome User, <h2 th:text="${principal}"></h2></p><br>
    <h4>Bearer Token: <h3 th:text="${token}"></h3></h4>

    <div th:if="${admin}">
        <table>
            <thead>
            <h1>Perform Action: </h1>
            <tr>
                <th>User ID</th>
                <th>Username</th>
                <th>Email</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
                <tr th:each="user, iterator : ${userList}">
                    <td th:text="${user.id}"></td>
                    <td th:text="${user.name}"></td>
                    <td th:text="${user.email}"></td>
                    <td>
                        <button class="update-button" th:onclick="'updateUser(' + ${user.id} + ')'">Update</button>
                        <button class="delete-button" th:onclick="'deleteUser(' + ${user.id} + ')'">Delete</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</main>

<footer class="footer">
    <div class="footer-content">
        Footer Content Here
    </div>
</footer>
</body>

<script>
    function logout() {
        window.location.href = "/logout"
    }

    function deleteUser(userId) {
        console.log("Deleting user with ID: " + userId);
        fetch(`/internsathi/admin/deleteUser?${userId}`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json',
            },
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                // Handle the response from the server (optional)
                return response.json();
            })
            .then(data => {
                console.log('Delete request successful', data);
                // Refresh the page or update the table (optional)
                // window.location.reload();
            })
            .catch(error => {
                console.error('Error:', error);
            });
    }

    function updateUser(userId) {
        console.log("Updating user with ID: " + userId);
    }
</script>
</html>
